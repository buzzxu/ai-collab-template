---
name: sync
description: |
  查看项目进度，验证任务状态与代码实际状态的一致性。
  Use when: 查看项目进度、同步检查、验证任务状态。
  Triggers: "/sync", "项目进度", "同步检查", "进度怎么样"
---

# /sync - 进度同步

> 查看项目进度，验证任务状态与代码实际状态的一致性

---

## 触发条件

用户说：
- "项目进度"
- "同步检查"
- "/sync"
- "还有什么要做"
- "进度怎么样"

---

## 执行流程

### Step 1: 读取所有任务

遍历 `project/tasks/*.yaml`，加载所有任务。

### Step 2: 统计进度

计算各模块和整体进度：

```
Frontend: {completed}/{total} ({percent}%)
Backend:  {completed}/{total} ({percent}%)
Docs:     {completed}/{total} ({percent}%)
──────────────────────────────────────
Total:    {completed}/{total} ({percent}%)
```

### Step 3: 验证已完成任务

对每个 `status: completed` 的任务：
1. 重新执行 `done_when` 检查
2. 记录通过/失败状态

### Step 4: 验证 session.md 一致性

> **重要**: 检查 `.context/session.md` 与任务文件的一致性

**检查项**:
1. session.md 中提到的 "进行中" 任务是否确实是 `status: in_progress`
2. session.md 中的进度数据是否与实际统计匹配

### Step 5: 生成报告

```markdown
## 项目进度报告

**生成时间**: {日期时间}

### 整体进度

| 模块 | 完成 | 进行中 | 待开始 | 进度条 |
|------|:----:|:------:|:------:|--------|
| Frontend | {n} | {n} | {n} | ████░░░░ {percent}% |
| Backend | {n} | {n} | {n} | ██████░░ {percent}% |
| Docs | {n} | {n} | {n} | ███████░ {percent}% |

**总进度**: {completed}/{total} ({percent}%)

---

### 当前进行中

| 任务 | 名称 | 负责人 |
|------|------|--------|
{列出 in_progress 任务}

---

### 一致性检查

**任务验收检查**:
{如果所有 completed 任务验证通过}
✅ 所有已完成任务验证通过

{如果有不一致}
⚠️ 发现 {n} 个不一致:

| 任务 | 问题 |
|------|------|
| {id} | {失败的检查项} |

---

### 下一步建议

按优先级排序，依赖已满足：

| 优先级 | 任务 | 名称 |
|:------:|------|------|
| P0 | {id} | {name} |
| P1 | {id} | {name} |

---

### 阻塞任务

{如果有 blocked 任务}
| 任务 | 阻塞原因 |
|------|----------|
| {id} | {原因} |

{如果没有}
无阻塞任务
```

---

## 快速模式

如果用户只想看进度，不需要验证：

**输入**: "快速进度" 或 "/sync --quick"

只输出统计信息，跳过一致性检查。

---

## 示例

**输入**: `/sync`

**输出**:

```
## 项目进度报告

**生成时间**: 2026-01-17 15:30

### 整体进度

| 模块 | 完成 | 进行中 | 待开始 | 进度 |
|------|:----:|:------:|:------:|------|
| Frontend | 6 | 0 | 11 | ████░░░░░░ 35% |
| Backend | 12 | 0 | 7 | ████████░░ 63% |
| Docs | 8 | 1 | 2 | █████████░ 73% |

**总进度**: 26/47 (55%)

---

### 当前进行中

| 任务 | 名称 | 负责人 |
|------|------|--------|
| DOC-9 | Tasks 目录迁移 | claude |

---

### 一致性检查

✅ 所有已完成任务验证通过

---

### 下一步建议

| 优先级 | 任务 | 名称 |
|:------:|------|------|
| P0 | FE-1.5 | Pinia 状态管理 |
| P0 | FE-1.7 | HTTP 客户端封装 |
```
